# Что такое необъявленная переменная?

Необъявленная переменная — это переменная, которая используется в коде без предварительного объявления через `var`, `let`, `const` или без явного присваивания. Понимание необъявленных переменных критически важно для написания правильного JavaScript кода и избежания ошибок и неожиданного поведения.

## Что такое необъявленная переменная?

Необъявленная переменная — это переменная, которая:
- ❌ **Не объявлена** — через `var`, `let`, `const`
- ❌ **Не является параметром функции** — не передана как аргумент
- ❌ **Не является свойством объекта** — не часть объекта
- ⚠️ **Создается автоматически** — в глобальной области видимости (в не strict mode)

### Примеры:

```javascript
// Необъявленная переменная
x = 10; // x не объявлена, но создается в глобальной области

// Объявленная переменная
let y = 20; // y объявлена через let
const z = 30; // z объявлена через const
var w = 40; // w объявлена через var
```

## Поведение в разных режимах

### Не strict mode:

```javascript
// Необъявленная переменная создается в глобальной области
function test() {
  x = 10; // Создается глобальная переменная x
}

test();
console.log(x); // 10 (доступна глобально)
console.log(window.x); // 10 (в браузере)
```

### Strict mode:

```javascript
"use strict";

function test() {
  x = 10; // ReferenceError: x is not defined
}

test(); // Ошибка
```

## Разница между необъявленными и undefined

### Необъявленная переменная:

```javascript
// ❌ Ошибка - переменная не существует
console.log(undeclaredVar); // ReferenceError: undeclaredVar is not defined

// ❌ Ошибка при присваивании (в strict mode)
"use strict";
undeclaredVar = 10; // ReferenceError
```

### Объявленная, но не инициализированная:

```javascript
// ✅ Переменная объявлена, но не инициализирована
let declaredVar;
console.log(declaredVar); // undefined (не ошибка)

// ✅ Можно присваивать
declaredVar = 10;
console.log(declaredVar); // 10
```

## Проблемы необъявленных переменных

### 1. **Загрязнение глобальной области**

```javascript
// ❌ Проблема - создается глобальная переменная
function calculate() {
  result = 10 * 5; // result становится глобальной
}

calculate();
console.log(result); // 50 (глобальная переменная)
console.log(window.result); // 50 (в браузере)
```

### 2. **Конфликты имен**

```javascript
// ❌ Проблема - может перезаписать существующую переменную
var libraryName = "MyLibrary";

function init() {
  libraryName = "OtherLibrary"; // Перезаписывает глобальную
}

init();
console.log(libraryName); // "OtherLibrary" (изменилась!)
```

### 3. **Ошибки в strict mode**

```javascript
"use strict";

// ❌ Ошибка - необъявленная переменная
function test() {
  x = 10; // ReferenceError: x is not defined
}

test();
```

## Как проверить необъявленную переменную?

### Проверка существования:

```javascript
// ❌ Неправильно - вызовет ошибку
if (undeclaredVar) {
  // ReferenceError если переменная не существует
}

// ✅ Правильно - проверка через typeof
if (typeof undeclaredVar !== "undefined") {
  // Переменная существует
}

// ✅ Или через try-catch
try {
  if (undeclaredVar) {
    // Переменная существует
  }
} catch (e) {
  // Переменная не существует
}
```

## Практические примеры

### Пример 1: Случайное создание глобальной переменной

```javascript
// ❌ Проблема - опечатка
function calculateTotal(items) {
  toatl = 0; // Опечатка: должно быть total
  for (let item of items) {
    toatl += item.price; // Создается глобальная toatl
  }
  return total; // ReferenceError: total is not defined
}

// ✅ Решение - объявить переменную
function calculateTotal(items) {
  let total = 0; // Правильно объявлена
  for (let item of items) {
    total += item.price;
  }
  return total;
}
```

### Пример 2: Strict mode предотвращает ошибки

```javascript
"use strict";

// ❌ Ошибка - необъявленная переменная
function test() {
  x = 10; // ReferenceError: x is not defined
  return x;
}

// ✅ Решение - объявить переменную
function test() {
  let x = 10; // Правильно объявлена
  return x;
}
```

### Пример 3: Проверка перед использованием

```javascript
// ✅ Безопасная проверка
function useVariable() {
  if (typeof myVar !== "undefined") {
    console.log(myVar);
  } else {
    console.log("Переменная не объявлена");
  }
}

useVariable(); // "Переменная не объявлена"

let myVar = "value";
useVariable(); // "value"
```

## Лучшие практики

### ✅ Делайте:

1. **Всегда объявляйте переменные** — через `let`, `const`, `var`
2. **Используйте strict mode** — для предотвращения ошибок
3. **Проверяйте через typeof** — перед использованием
4. **Используйте линтеры** — для обнаружения необъявленных переменных

### ❌ Не делайте:

1. **Не создавайте необъявленные переменные** — всегда объявляйте
2. **Не полагайтесь на глобальные переменные** — объявляйте явно
3. **Не игнорируйте ошибки** — исправляйте необъявленные переменные
4. **Не используйте без проверки** — проверяйте существование

## Инструменты для обнаружения

### ESLint:

```javascript
// ESLint правило: no-undef
// Обнаруживает необъявленные переменные

// ❌ ESLint предупредит
x = 10; // 'x' is not defined

// ✅ Правильно
let x = 10;
```

### TypeScript:

```typescript
// TypeScript обнаружит необъявленные переменные на этапе компиляции

// ❌ Ошибка компиляции
x = 10; // Cannot find name 'x'

// ✅ Правильно
let x = 10;
```

## Заключение

Необъявленная переменная:

- **Не объявлена** — через `var`, `let`, `const`
- **Создается глобально** — в не strict mode
- **Ошибка в strict mode** — ReferenceError
- **Проблемы** — загрязнение глобальной области, конфликты

**Помните:** всегда объявляйте переменные перед использованием. Используйте `let` и `const` вместо `var`, включайте strict mode для предотвращения случайного создания глобальных переменных, и используйте линтеры для обнаружения необъявленных переменных. Понимание необъявленных переменных критически важно для написания правильного и безопасного JavaScript кода.

